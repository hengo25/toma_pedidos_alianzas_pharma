<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>Productos</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container py-4">

  <div class="d-flex justify-content-between align-items-center mb-3">
    <h1>Productos</h1>
    <div class="btn-group">
      <a href="{{ url_for('clientes') }}" class="btn btn-outline-primary">👥 Clientes</a>
      <a href="{{ url_for('pedido') }}" class="btn btn-success">🛒 Nuevo Pedido</a>
    </div>
  </div>

  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for cat,msg in messages %}
        <div class="alert alert-{{cat}}">{{msg}}</div>
      {% endfor %}
    {% endif %}
  {% endwith %}

  <form class="mb-3" method="get" action="{{ url_for('index') }}">
    <div class="input-group">
      <input class="form-control" name="q" value="{{ q }}" placeholder="Buscar por nombre, laboratorio o descripción...">
      <button class="btn btn-outline-secondary">Buscar</button>
    </div>
  </form>

  <form method="post" action="{{ url_for('producto_add') }}" class="row g-2 mb-4">
    <div class="col-md-3"><input class="form-control" name="nombre" placeholder="Nombre" required></div>
    <div class="col-md-3"><input class="form-control" name="descripcion" placeholder="Descripción"></div>
    <div class="col-md-2"><input class="form-control" name="laboratorio" placeholder="Laboratorio"></div>
    <div class="col-md-2"><input class="form-control" name="precio" type="number" step="0.01" placeholder="Precio" required></div>
    <div class="col-md-2"><input class="form-control" name="inventario" type="number" placeholder="Inventario" required></div>
    <div class="col-12"><button class="btn btn-success mt-2">Agregar Producto</button></div>
  </form>

  <table class="table table-striped">
    <thead class="table-dark">
      <tr>
        <th>Nombre</th><th>Descripción</th><th>Laboratorio</th><th>Precio</th><th>Inventario</th><th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      {% for p in productos %}
      <tr>
        <td>{{ p.nombre }}</td>
        <td>{{ p.descripcion }}</td>
        <td>{{ p.laboratorio }}</td>
        <td>${{ '%.2f'|format(p.precio) }}</td>
        <td>{{ p.inventario }}</td>
        <td class="d-flex gap-2">
          <a href="{{ url_for('producto_edit', producto_id=p.id) }}" class="btn btn-warning btn-sm">Editar</a>
          <a href="{{ url_for('producto_delete', producto_id=p.id) }}" class="btn btn-danger btn-sm" onclick="return confirm('¿Eliminar producto?')">Eliminar</a>
        </td>
      </tr>
      {% else %}
      <tr><td colspan="6">No hay productos.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</body>
</html>
